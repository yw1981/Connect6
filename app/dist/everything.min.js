var gameLogic;!function(a){"use strict";function b(){return[["","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","",""]]}function c(){return{totalMove:0,winner:"",moveIndex:1}}function d(a){return a.totalMove>=361}function e(a,b,c,d){var e,f;for(e=b-1,f=b+1;e>=0&&a[e][c]===d;)e--;for(;f<a.length&&a[f][c]===d;)f++;if(f-e-1>=6)return!0;for(e=c-1,f=c+1;e>=0&&a[b][e]===d;)e--;for(;f<a.length&&a[b][f]===d;)f++;if(f-e-1>=6)return!0;for(e=-1,f=1;b+e>=0&&c+e>=0&&a[b+e][c+e]===d;)e--;for(;b+f<a.length&&c+f<a.length&&a[b+f][c+f]===d;)f++;if(f-e-1>=6)return!0;for(e=-1,f=1;b+e>=0&&c-e<a.length&&a[b+e][c-e]===d;)e--;for(;b+f<a.length&&c-f>=0&&a[b+f][c-f]===d;)f++;return f-e-1>=6?!0:!1}function f(a,b,c,d){var e,f,g,h=0;for(e=b-1,f=b+1;e>=0&&a[e][c]===d;)e--;for(;f<a.length&&a[f][c]===d;)f++;if(g=f-e-1,5===g&&(f<a.length&&""===a[f][c]||e>=0&&""===a[e][c])||6===g)return 1;for((3===g&&f<a.length&&""===a[f][c]&&e>=0&&""===a[e][c]||4===g)&&h++,e=c-1,f=c+1;e>=0&&a[b][e]===d;)e--;for(;f<a.length&&a[b][f]===d;)f++;if(g=f-e-1,5===g&&(f<a.length&&""===a[b][f]||e>=0&&""===a[b][e])||6===g)return 1;for((3===g&&f<a.length&&""===a[b][f]&&e>=0&&""===a[b][e]||4===g)&&h++,e=-1,f=1;b+e>=0&&c+e>=0&&a[b+e][c+e]===d;)e--;for(;b+f<a.length&&c+f<a.length&&a[b+f][c+f]===d;)f++;if(g=f-e-1,5===g&&(b+f<a.length&&""===a[b+f][c+f]||b+e>=0&&""===a[b+e][c+e])||6===g)return 1;for((3===g&&b+f<a.length&&""===a[b+f][c+f]&&b+e>=0&&""===a[b+e][c+e]||4===g)&&h++,e=-1,f=1;b+e>=0&&c-e<a.length&&a[b+e][c-e]===d;)e--;for(;b+f<a.length&&c-f>=0&&a[b+f][c-f]===d;)f++;return g=f-e-1,5===g&&(b+f<a.length&&""===a[b+f][c-f]||b+e>=0&&""===a[b+e][c-e])||6===g?1:((3===g&&b+f<a.length&&""===a[b+f][c-f]&&b+e>=0&&""===a[b+e][c-e]||4===g)&&h++,h>=2?2:0)}function g(a,f,g,h,i){if(void 0===a&&(a=b()),void 0===i&&(i=c()),""!==a[f][g])throw new Error("One can only make a move in an empty position!");if(""!==i.winner)throw new Error("Can only make a move if the game is not over!");var j,k,l=angular.copy(a),m=angular.copy(i);return m.moveIndex=(m.moveIndex+1)%4,m.totalMove++,l[f][g]=0===h?"X":"O",k=e(l,f,g,l[f][g])?l[f][g]:"",j=""!==k||d(m)?{endMatch:{endMatchScores:"X"===k?[1,0]:"O"===k?[0,1]:[0,0]}}:{setTurn:{turnIndex:0===m.moveIndex||1===m.moveIndex?0:1}},m.winner=k,[j,{set:{key:"board",value:l}},{set:{key:"delta",value:{row:f,col:g}}},{set:{key:"gameData",value:m}}]}function h(a,b,c,d){var e=[],f=[],g=[],h=[],i=[];void 0===c&&(c={row:9,col:8});for(var k=c.row,l=c.col,m=2*Math.max(18-k,k,18-l,l)+1,n=0,o=0,p=0;;){if(++n===m)break;for(p=0;n>p;p++)j(k,++l,a,b,d,f,g,e,i,h);if(++o===m)break;for(p=0;o>p;p++)j(++k,l,a,b,d,f,g,e,i,h);if(++n===m)break;for(p=0;n>p;p++)j(k,--l,a,b,d,f,g,e,i,h);if(++o===m)break;for(p=0;o>p;p++)j(--k,l,a,b,d,f,g,e,i,h)}return{winMoves:f,threatMoves:g.concat(i.concat(h)),possibleMoves:e}}function i(a,b,c,d){var e=h(a,b,c,d);return e.winMoves.concat(e.threatMoves.concat(e.possibleMoves))}function j(a,b,c,d,e,h,i,j,k,l){if(!(0>a||a>18||0>b||b>18)){var m,n=0===d?"O":"X",o=0===d?"X":"O";try{m=g(c,a,b,d,e);var p=f(c,a,b,n),q=f(c,a,b,o);m[0].endMatch||1===q&&(2===e.moveIndex||0===e.moveIndex)?h.push(m):1===p?i.push(m):2===p?k.push(m):2===q?l.push(m):j.push(m)}catch(r){}}}function k(a){var b=a.move,c=a.turnIndexBeforeMove,d=a.stateBeforeMove;try{var e=b[2].set.value,f=e.row,h=e.col,i=d.board,j=d.gameData,k=g(i,f,h,c,j);if(!angular.equals(b,k))return!1}catch(l){return!1}return!0}a.getInitialBoard=b,a.getInitialGameData=c,a.createMove=g,a.getDifferentMoves=h,a.getPossibleMoves=i,a.isMoveOk=k}(gameLogic||(gameLogic={}));var game;!function(a){function b(){console.log("Translation of 'RULES_OF_CONNECT6' is "+translate("RULES_OF_CONNECT6")),resizeGameAreaService.setWidthToHeight(1),dragAndDropService.addDragListener("gameArea",m),gameService.setGame({minNumberOfPlayers:2,maxNumberOfPlayers:2,isMoveOk:gameLogic.isMoveOk,updateUI:e}),document.addEventListener("animationend",c,!1),document.addEventListener("webkitAnimationEnd",c,!1),document.addEventListener("oanimationend",c,!1)}function c(){$rootScope.$apply(function(){log.info("Animation ended"),u=!0,p&&d()})}function d(){gameService.makeMove(aiService.createComputerMove(q,r,{maxDepth:1}))}function e(b){u=!1,q=b.stateAfterMove,t=b.playMode,s=b.turnIndexBeforeMove,void 0===q.board&&(a.isHelpModalShown=!1,u=!0,q.board=gameLogic.getInitialBoard()),void 0===q.gameData&&(q.gameData=gameLogic.getInitialGameData()),o=b.turnIndexAfterMove>=0&&b.yourPlayerIndex===b.turnIndexAfterMove,r=b.turnIndexAfterMove,p=o&&""===b.playersInfo[b.yourPlayerIndex].playerId,p&&(o=!1,void 0===q.delta&&d())}function f(a,b){if(log.info(["Clicked on cell:",a,b]),o)try{var c=gameLogic.createMove(q.board,a,b,r,q.gameData);o=!1,gameService.makeMove(c)}catch(d){return void log.info(["Cell is already full in position:",a,b])}}function g(a,b){var c=q.board[a][b];return""!==c}function h(a,b){var c=q.board[a][b];return"X"===c?"imgsrc/black.png":"O"===c?"imgsrc/white.png":""}function i(a,b){var c=!u&&void 0!==q.delta&&q.delta.row===a&&q.delta.col===b;return c&&("playAgainstTheComputer"===t&&0===s||"passAndPlay"===t||"playBlack"===t&&1===s||"playWhite"===t&&0===s)}function j(a,b){var c=!u&&void 0!==q.delta&&q.delta.row===a&&q.delta.col===b;return c&&!i(a,b)}function k(a,b){return{piece:!0,animation:j(a,b),slowlyAppear:i(a,b)}}function l(a){for(var b=[],c=0;a>c;c++)b.push(c);return b}function m(b,c,d){function e(){return{width:n.clientWidth/a.colsNum,height:n.clientHeight/a.rowsNum}}function g(a,b){var c=e();return{top:a*c.height,left:b*c.width}}function h(a,b){var c=e();return{x:b*c.width+c.width/2,y:a*c.height+c.height/2}}function i(a,b){f(a,b),log.info("Dragged to "+a+"x"+b)}if(log.info("handleDragEvent",o,u,b,c,d),o&&u){var j=document.getElementById("draggingLines"),k=document.getElementById("horizontalDraggingLine"),l=document.getElementById("verticalDraggingLine"),m=document.getElementById("clickToDragPiece"),n=document.getElementById("gameArea"),p=c-n.offsetLeft,q=d-n.offsetTop;if(0>p||0>q||p>=n.clientWidth||q>=n.clientHeight)return m.style.display="none",void(j.style.display="none");m.style.display="inline",j.style.display="inline";var r=Math.floor(a.colsNum*p/n.clientWidth),s=Math.floor(a.rowsNum*q/n.clientHeight),t=h(s,r);l.setAttribute("x1",t.x),l.setAttribute("x2",t.x),k.setAttribute("y1",t.y),k.setAttribute("y2",t.y);var v=g(s,r);m.style.left=v.left+"px",m.style.top=v.top+"px",("touchend"===b||"touchcancel"===b||"touchleave"===b||"mouseup"===b)&&(m.style.display="none",j.style.display="none",i(s,r))}}function n(){return 1===r?"imgsrc/white.png":"imgsrc/black.png"}a.isHelpModalShown=!1,a.rowsNum=19,a.colsNum=19,a.rows=l(a.rowsNum),a.cols=l(a.colsNum);var o=!1,p=!1,q=null,r=null,s=null,t=null,u=!0;a.init=b,a.cellClicked=f,a.shouldShowImage=g,a.getImageSrc=h,a.getClass=k,a.handleDragEvent=m,a.getPreviewSrc=n}(game||(game={})),angular.module("myApp",["ngTouch","ui.bootstrap","gameServices"]).run(function(){$rootScope.game=game,translate.setLanguage("en",{RULES_OF_CONNECT6:"Rules of Connect6",RULES_SLIDE1:"You and your opponent take turns to place stones on the board. Black makes the first move and can only place one stone on the board.",RULES_SLIDE2:"After first move, each player (must) place two stones every move.",RULES_SLIDE3:"The first to get six stones in a row, column or diagonal wins.",CLOSE:"Close"}),game.init()});var aiService;!function(a){"use strict";function b(a){if(a[0].endMatch){var b=a[0].endMatch.endMatchScores;return b[0]>b[1]?Number.POSITIVE_INFINITY:b[0]<b[1]?Number.NEGATIVE_INFINITY:0}var d=a[1].set.value,e=a[2].set.value.row,f=a[2].set.value.col,g=c(d,e,f,"X"),h=c(d,e,f,"O");return h-g}function c(a,b,c,d){var e,f,g=0;for(e=b-1,f=b+1;e>=0&&a[e][c]===d;)e--;for(;f<a.length&&a[f][c]===d;)f++;for(g+=f-e-2,e=c-1,f=c+1;e>=0&&a[b][e]===d;)e--;for(;f<a.length&&a[b][f]===d;)f++;for(g+=f-e-2,e=-1,f=1;b+e>=0&&c+e>=0&&a[b+e][c+e]===d;)e--;for(;b+f<a.length&&c+f<a.length&&a[b+f][c+f]===d;)f++;for(g+=f-e-2,e=-1,f=1;b+e>=0&&c-e<a.length&&a[b+e][c-e]===d;)e--;for(;b+f<a.length&&c-f>=0&&a[b+f][c-f]===d;)f++;return g+=f-e-2}function d(a,b){return gameLogic.getPossibleMoves(a[1].set.value,b,a[2].set.value,a[3].set.value)}function e(a){return"\n"+a[1].set.value.join("\n")+"\n"}function f(a,c,f){var g=gameLogic.getDifferentMoves(a.board,c,a.delta,a.gameData),h=g.winMoves,i=g.threatMoves;return 0!==h.length?h[0]:0!==i.length?i[0]:alphaBetaService.alphaBetaDecision([null,{set:{key:"board",value:a.board}},{set:{key:"delta",value:a.delta}},{set:{key:"gameData",value:a.gameData}}],c,d,b,"?debug"===window.location.search?e:null,f)}a.createComputerMove=f}(aiService||(aiService={}));
//# sourceMappingURL=everything.min.js.map